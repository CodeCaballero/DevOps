#code $PROFILE
Import-Module Az -ErrorAction SilentlyContinue

$RepoBaseUrl = "https://raw.githubusercontent.com/CodeCaballero/DevOps/main"

function zap ($Namespace) {
    if (-not (Get-AzContext)) { Connect-AzAccount }
    
    $Url = "$RepoBaseUrl/Register-AzResourceProvider.ps1"
    try {
        $Code = Invoke-RestMethod -Uri $Url
        Invoke-Command -ScriptBlock ([scriptblock]::Create($Code)) -ArgumentList $Namespace
    }
    catch {
        Write-Error "Failed to reach GitHub or execute script."
    }
}

Write-Host "`n--- @CodeCaballero Toolbox Loaded ---" -ForegroundColor Cyan